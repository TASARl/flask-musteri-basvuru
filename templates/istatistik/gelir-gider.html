{% extends "modul__base_yeni.html" %}
{% block styles %}
<style>
#chart {
  max-width: 760px;
  margin: 35px auto;
  opacity: 0.9;
}

.custom-tooltip {
  padding: 2px 10px 5px;
}

.custom-tooltip .group:nth-child(3) {
  border-top: 1px solid #e4e4e4;
}

.group1 {
  color: #2a8ff7;
}
.group2 {
  color: #68e497;
}

.group {
  padding: 4px 0;
  font-weight: light;
  color: #111;
}

.group span {
  font-style: italic !important;
  color: #888;
}

</style>
{% endblock %}


{% block title %}HızlıKredi | En Hızlı Taşıt Kredisi{% endblock %}


{% block content %}

<div class="card card-bordered">
    <div class="card-body">
        <div id="chart">
        </div>
    </div>
</div>
{% endblock %}



{% block scripts %} 

<script>
    $(document).ready(function() {
    var options = {
        chart: {
            height: 350,
            type: "line"
        },
        dataLabels: {
            enabled: false
        },
        stroke: {
            curve: "straight"
        },
        series: [
            {
                type: "line",
                name: "Gelir",
                data: []
            },
            {
                name: "Net Kazanç",
                type: "area",
                data: []
            },
            {
                type: "line",
                name: "Gider",
                data: []
            }
        ],
        markers: {
            size: 6,
            hover: {
                size: 8
            }
        },
        xaxis: {
            type: "datetime",
            categories: []
        },
        tooltip: {
            custom: function({ series, seriesIndex, dataPointIndex, w }) {
                return (
                    '<div class="custom-tooltip">' +
                    '<div class="group">' +
                    "<div><span>Current Week</span> <br />" +
                    w.config.xaxis.categories[dataPointIndex] +
                    "</div>" +
                    '<div class="group1">Views: ' +
                    series[0][dataPointIndex] +
                    "</div>" +
                    "</div>" +
                    '<div class="group">' +
                    "<div><span>Previous Week</span> <br />" +
                    w.config.xaxis.categories[dataPointIndex] +
                    "</div>" +
                    '<div class="group2">Views: ' +
                    series[1][dataPointIndex] +
                    "</div>" +
                    "</div>" +
                    "</div>"
                );
            }
        },
        fill: {
            opacity: [1, 0.2]
        },
        legend: {
            onItemClick: {
                toggleDataSeries: false
            }
        }
    };

    var chart = new ApexCharts(document.querySelector("#chart"), options);

    chart.render();

    // AJAX request'i ile verileri çekiyoruz.
    $.ajax({
        url: "/gelir-gider-chart-data",
        method: "GET",
        success: function(response) {
            chart.updateSeries([
                { data: response.revenue },
                { data: response.net_income },
                { data: response.expenses }
            ]);
            chart.updateOptions({
                xaxis: {
                    categories: response.categories
                }
            });
        }
    });
});

</script>
{% endblock %}